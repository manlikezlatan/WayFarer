{"version":3,"sources":["../../api/test/tripTest.js"],"names":["chai","use","chaiHttp","should","fare","bus_id","origin","destination","trip_date","Date","token","jwt","sign","email","user_id","is_admin","first_name","last_name","process","env","SECRET","expiresIn","beforeEach","pool","query","err","describe","it","done","request","app","post","end","res","have","status","body","be","a","property","eql","trip","set","send","get","data","undefined","patch"],"mappings":"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","sourcesContent":["import chai from 'chai';\r\nimport chaiHttp from 'chai-http';\r\nimport jwt from 'jsonwebtoken';\r\nimport moment from 'moment';\r\nimport app from '../app';\r\nimport pool from '../models/dbPool';\r\n\r\nchai.use(chaiHttp);\r\nconst should = chai.should();\r\nshould;\r\n\r\nconst fare = 3000.00;\r\nconst bus_id = 1;\r\nconst origin = 'Duai';\r\nconst destination = 'London';\r\nconst trip_date = moment(new Date());\r\nconst token = jwt.sign(\r\n  {\r\n    email: 'zlatan@gmail.com',\r\n    user_id: 1,\r\n    is_admin: true,\r\n    first_name: 'Ibrahim',\r\n    last_name: 'Babatunde',\r\n  },\r\n  process.env.SECRET,\r\n  {\r\n    expiresIn: '2h',\r\n  },\r\n);\r\nbeforeEach(() => {\r\n  pool.query('TRUNCATE TABLE trips CASCADE',\r\n    err => err);\r\n});\r\n\r\n// Test for creating a trip\r\ndescribe('/POST create new trip', () => {\r\n  it('it should not create a trip if authorization token is not provided', (done) => {\r\n    chai.request(app)\r\n      .post('/api/v1/trips')\r\n      .end((err, res) => {\r\n        res.should.have.status(400);\r\n        res.body.should.be.a('object');\r\n        res.body.should.have.property('status').eql('error');\r\n        res.body.should.have.property('error').eql('Kindly provide token');\r\n        done(err);\r\n      });\r\n  });\r\n\r\n  it('it should not create a trip with no specified origin', (done) => {\r\n    const trip = {\r\n      bus_id,\r\n      origin: '',\r\n      destination,\r\n      trip_date,\r\n      fare,\r\n    };\r\n    chai.request(app)\r\n      .post('/api/v1/trips')\r\n      .set('token', token)\r\n      .send(trip)\r\n      .end((err, res) => {\r\n        res.should.have.status(400);\r\n        res.body.should.be.a('object');\r\n        res.body.should.have.property('status').eql('error');\r\n        res.body.should.have.property('error').eql('Kindly fill the all required details for the trip');\r\n        done(err);\r\n      });\r\n  });\r\n\r\n  it('it should not create a trip without a specified destination', (done) => {\r\n    const trip = {\r\n      bus_id,\r\n      origin,\r\n      trip_date,\r\n      fare,\r\n      destination: ''\r\n    };\r\n    chai.request(app)\r\n      .post('/api/v1/trips')\r\n      .set('token', token)\r\n      .send(trip)\r\n      .end((err, res) => {\r\n        res.should.have.status(400);\r\n        res.body.should.be.a('object');\r\n        res.body.should.have.property('status').eql('error');\r\n        res.body.should.have.property('error').eql('Kindly fill the all required details for the trip');\r\n        done(err);\r\n      });\r\n  });\r\n\r\n  it('it should not create a trip without a specified bus id', (done) => {\r\n    const trip = {\r\n      bus_id: '',\r\n      origin,\r\n      destination,\r\n      trip_date,\r\n      fare,\r\n    };\r\n    chai.request(app)\r\n      .post('/api/v1/trips')\r\n      .set('token', token)\r\n      .send(trip)\r\n      .end((err, res) => {\r\n        res.should.have.status(400);\r\n        res.body.should.be.a('object');\r\n        res.body.should.have.property('status').eql('error');\r\n        res.body.should.have.property('error').eql('Kindly fill the all required details for the trip');\r\n        done(err);\r\n      });\r\n  });\r\n\r\n  it('it should post and create a trip', (done) => {\r\n    const trip = {\r\n      bus_id,\r\n      origin,\r\n      destination,\r\n      trip_date,\r\n      fare,\r\n    };\r\n    chai.request(app)\r\n      .post('/api/v1/trips')\r\n      .set('token', token)\r\n      .send(trip)\r\n      .end((err, res) => {\r\n        res.should.have.status(201);\r\n        res.body.should.be.a('object');\r\n        res.body.should.have.property('status').eql('success');\r\n        res.body.should.have.property('message').eql('Trip created successfully');\r\n        res.body.should.have.property('data');\r\n        done(err);\r\n      });\r\n  });\r\n});\r\n\r\ndescribe('/GET/ all trips', () => {\r\n  it('it should return no trips if there are no trips yet', (done) => {\r\n    chai.request(app)\r\n      .get('/api/v1/trips')\r\n      .set('token', token)\r\n      .end((err, res) => {\r\n        if (res.body.data === undefined) {\r\n          res.should.have.status(404);\r\n          res.body.should.be.a('object');\r\n          res.body.should.have.property('status').eql('error');\r\n          res.body.should.have.property('error').eql('There are currently no trips');\r\n        }\r\n        done(err);\r\n      });\r\n  });\r\n\r\n  it('it should get trips for all users', (done) => {\r\n    chai.request(app)\r\n      .get('/api/v1/trips')\r\n      .set('token', token)\r\n      .end((err, res) => {\r\n        if (!res.body.data === undefined) {\r\n          res.should.have.status(200);\r\n          res.body.should.be.a('object');\r\n          res.body.should.have.property('status').eql('success');\r\n          res.body.should.have.property('data');\r\n        }\r\n        done(err);\r\n      });\r\n  });\r\n});\r\n\r\n// Cancel a trip\r\ndescribe('/DELETE/ Cancel trips', () => {\r\n  it('it should return a response if there are no trips with that id', (done) => {\r\n    chai.request(app)\r\n      .patch('/api/v1/trips/1')\r\n      .set('token', token)\r\n      .end((err, res) => {\r\n        if (res.body.data === undefined) {\r\n          res.should.have.status(400);\r\n          res.body.should.be.a('object');\r\n          res.body.should.have.property('status').eql('error');\r\n          res.body.should.have.property('error').eql('There is no trip with that id');        \r\n        }\r\n        done(err);\r\n      });\r\n  });\r\n  it('it should return trip cancelled successfully', (done) => {\r\n    chai.request(app)\r\n      .patch('/api/v1/trips/1')\r\n      .set('token', token)\r\n      .end((err, res) => {\r\n        if (!res.body.data === undefined) {\r\n          res.should.have.status(200);\r\n          res.body.should.be.a('object');\r\n          res.body.should.have.property('status').eql('success');\r\n          res.body.data.should.have.property('message').eql('Trip cancelled successfully');\r\n        }\r\n        done(err);\r\n    });\r\n  });\r\n});\r\n"],"file":"tripTest.js"}